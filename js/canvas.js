const t=window.devicePixelRatio||1;function e(e="reviewer"){const n=document.querySelector(".board");if(!n)throw new Error("[CANVAS_ERROR] Chess board was not found!");const o=n.getBoundingClientRect();let i=document.getElementById(e);if(!i){i=document.createElement("canvas"),i.id=e,i.classList.add("board-canvas"),i.width=o.width+10,i.height=i.width,i.style.top="50%",i.style.left="50%",i.style.transform="translate(-50%, -50%)";const r=i.getContext("2d"),d=i.width+10;i.width=d*t,i.height=d*t,i.style.width=`${d}px`,i.style.height=`${d}px`,r.scale(t,t),r.translate(10,10),n.append(i)}return[n,i]}export function removeCanvas(t){if(!t)throw new Error("[CANVAS_ERROR] canvasId is required");const e=document.getElementById(t);e?.remove()}export function drawArrow({origSquareId:n,destSquareId:o,canvasId:i="reviewer",color:r="limegreen"}){const[d,a]=e(i),l=document.getElementById(n),s=document.getElementById(o);if(!l||!s)throw new Error(`[CANVAS_ERROR] Unable to find the following squares: orig=${n} and dest=${o}`);const c=d.getBoundingClientRect(),h=c.left,g=c.top,u=l.getBoundingClientRect(),w=s.getBoundingClientRect(),y={x:u.left+u.width/2-h,y:u.top+u.height/2-g},x={x:w.left+w.width/2-h,y:w.top+w.height/2-g},f=x.x-y.x,m=x.y-y.y,R=Math.sqrt(f*f+m*m),C=Math.atan2(m,f),p=.88*R;x.x=y.x+Math.cos(C)*p,x.y=y.y+Math.sin(C)*p;const E=a.getContext("2d"),v=13.75-t,I=v+5;E.lineCap="round",E.lineWidth=v,E.strokeStyle=r,E.fillStyle=r,E.beginPath(),E.moveTo(y.x,y.y),E.lineTo(x.x,x.y),E.stroke();let A=Math.atan2(x.y-y.y,x.x-y.x);const B=()=>({x:I*Math.cos(A)+x.x,y:I*Math.sin(A)+x.y});E.beginPath(),E.moveTo(B().x,B().y),A+=1/3*(2*Math.PI),E.lineTo(B().x,B().y),A+=1/3*(2*Math.PI),E.lineTo(B().x,B().y),E.closePath(),E.fill()}export function drawEmojiAtSquare({squareId:t,emoji:n="âœ…",canvasId:o="reviewer"}){const i=document.getElementById(t);if(!i)throw new Error(`[CANVAS_ERROR] Unable to find square: ${t}`);const[r,d]=e(o),a=d.getContext("2d"),l=r.getBoundingClientRect(),s=i.getBoundingClientRect(),c=s.width,h=s.left+.65*s.width-l.left,g=s.top+.2*s.height-l.top;a.font=.35*c+"px Arial",a.textAlign="left",a.fillText(n,h,g)}