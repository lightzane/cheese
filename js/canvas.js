const t=window.devicePixelRatio||1;function e(e="analysis"){const n=document.querySelector(".board");if(!n)throw new Error("[CANVAS_ERROR] Chess board was not found!");const o=n.getBoundingClientRect();let i=document.getElementById(e);if(!i){i=document.createElement("canvas"),i.id=e,i.classList.add("board-canvas"),i.width=o.width+10,i.height=i.width,i.style.top="50%",i.style.left="50%",i.style.transform="translate(-50%, -50%)";const a=i.getContext("2d"),d=i.width+10;i.width=d*t,i.height=d*t,i.style.width=`${d}px`,i.style.height=`${d}px`,a.scale(t,t),a.translate(10,10),n.append(i)}return[n,i]}export function removeCanvas(t){if(!t)throw new Error("[CANVAS_ERROR] canvasId is required");const e=document.getElementById(t);e?.remove()}export function drawArrow({origSquareId:n,destSquareId:o,canvasId:i="analysis",color:a="limegreen"}){const[d,l]=e(i),r=document.getElementById(n),s=document.getElementById(o);if(!r||!s)throw new Error(`[CANVAS_ERROR] Unable to find the following squares: orig=${n} and dest=${o}`);const c=d.getBoundingClientRect(),h=c.left,g=c.top,y=r.getBoundingClientRect(),u=s.getBoundingClientRect(),x={x:y.left+y.width/2-h,y:y.top+y.height/2-g},f={x:u.left+u.width/2-h,y:u.top+u.height/2-g},w=f.x-x.x,m=f.y-x.y,R=Math.sqrt(w*w+m*m),C=Math.atan2(m,w),p=.88*R;f.x=x.x+Math.cos(C)*p,f.y=x.y+Math.sin(C)*p;const E=l.getContext("2d"),I=13.75-t,A=I+5;E.lineCap="round",E.lineWidth=I,E.strokeStyle=a,E.fillStyle=a,E.beginPath(),E.moveTo(x.x,x.y),E.lineTo(f.x,f.y),E.stroke();let v=Math.atan2(f.y-x.y,f.x-x.x);const B=()=>({x:A*Math.cos(v)+f.x,y:A*Math.sin(v)+f.y});E.beginPath(),E.moveTo(B().x,B().y),v+=1/3*(2*Math.PI),E.lineTo(B().x,B().y),v+=1/3*(2*Math.PI),E.lineTo(B().x,B().y),E.closePath(),E.fill()}export function drawEmojiAtSquare({squareId:t,emoji:n="âœ…",canvasId:o="analysis"}){const i=document.getElementById(t);if(!i)throw new Error(`[CANVAS_ERROR] Unable to find square: ${t}`);const[a,d]=e(o),l=d.getContext("2d"),r=a.getBoundingClientRect(),s=i.getBoundingClientRect(),c=s.width,h=s.left+.65*s.width-r.left,g=s.top+.2*s.height-r.top;l.font=.35*c+"px Arial",l.textAlign="left",l.fillText(n,h,g)}