<!DOCTYPE html> <html lang="en"> <head> <meta charset="UTF-8" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <title>Cheese</title> <link rel="shortcut icon" href="https://camo.githubusercontent.com/753d80753907c1c87695bc7af443b5497548cf80ca86ca5c1d14ac51a2882632/68747470733a2f2f696d616765732e6368657373636f6d66696c65732e636f6d2f63686573732d7468656d65732f7069656365732f6e656f2f3235362f776e2e706e67" /> <link rel="preconnect" href="https://fonts.googleapis.com" /> <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /> <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet"> <link href="https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500;700&display=swap" rel="stylesheet"> <style> *,::after,::before{box-sizing:border-box}*{margin:0;padding:0;font:inherit}ol[role=list],ul[role=list]{list-style:none}html:focus-within{scroll-behavior:smooth}body,html{height:100%}body{text-rendering:optimizeSpeed;line-height:1.5rem}a:not([class]){text-decoration-skip-ink:auto}img,picture,svg{max-width:100%;display:block}@media (prefers-reduced-motion:reduce){html:focus-within{scroll-behavior:auto}*,::after,::before{animation-duration:0s!important;animation-iteration-count:1!important;transition-duration:0s!important;scroll-behavior:auto!important}} #app,body{align-items:center;gap:.5rem}#app,body,main{gap:.5rem}.board,.square{position:relative}.board,.checkmate-container,.file,.piece img,.piece.dragging,.rank{touch-action:none}.fen,.pgn-row button,.pgn-row span{font-family:'Fira Mono',monospace;font-size:.875rem}.fen,.file,.rank{font-size:.875rem}*{font-family:Inter,system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,'Open Sans','Helvetica Neue',sans-serif}body{display:flex;flex-direction:column;background-color:hsl(231 15% 18%)}:root{--board-size:100vw;--square-size:12.5%;--color-dark:#ae8a68;--color-light:#ecdab9;--color-yellow:yellow;--color-blue:skyblue;--color-red:#ff7675;--piece-size:90%;--piece-drag-size:30vw;--shadow-md:0 4px 6px -1px rgb(0 0 0 / 0.1),0 2px 4px -2px rgb(0 0 0 / 0.1)}@media (min-width:554px){:root{--board-size:555px;--piece-drag-size:12vh}.eval.horizontal{display:none!important}aside{height:var(--board-size);width:250px}.pgn-container{height:100%;overflow-y:scroll}}.board,.eval{overflow:hidden;user-select:none}@media (max-width:555px){.eval.vertical,.fen{display:none}aside{width:100%}}#app,.board,.core,aside,main{display:flex}.fen{color:#fff;opacity:.1;letter-spacing:1px;font-weight:400;transition:.3s ease-in-out}.fen:hover{opacity:1}#app{justify-content:center;flex-wrap:wrap}main{align-items:center;justify-content:center;flex-direction:column;height:100svh}aside{border-radius:.3rem;background-color:rgba(255,255,255,.9);padding:.5rem;flex-direction:column;align-items:center;gap:1rem}aside #btnCopyFenPGN{padding:0 .5rem;font-size:.75rem;font-weight:500;border:none;cursor:pointer;text-transform:uppercase}.core{align-items:center;justify-content:center;gap:.3rem}.board{width:var(--board-size);height:var(--board-size);margin:0 auto;flex-wrap:wrap;border-radius:.3rem}.piece,.square{align-items:center;display:flex}.board.flip,.board.flip .square,.eval.vertical.flip,.eval.vertical.flip .num{transform:rotate(180deg)}.square{width:var(--square-size);height:var(--square-size);float:left;justify-content:center}.dark{background-color:var(--color-dark)}.light{background-color:var(--color-light)}.file,.rank{position:absolute;font-weight:500;user-select:none;pointer-events:none;z-index:100}.file{bottom:0;right:5%;font-size:1rem}.rank{top:0;left:5%}.board.flip .file:not(.flip),.board.flip .rank:not(.flip),.board:not(.flip) .file.flip,.board:not(.flip) .rank.flip{display:none}.square.dark .file,.square.dark .rank{color:var(--color-light)}.square.light .file,.square.light .rank{color:var(--color-dark)}.piece{width:100%;z-index:1;cursor:pointer;justify-content:center;user-select:none}.piece img{max-width:var(--piece-size);width:var(--piece-size);pointer-events:none;user-select:none}.piece.dragging{position:fixed;z-index:1000;width:var(--piece-drag-size);height:var(--piece-drag-size);pointer-events:none}.square .hl-legal-squares{pointer-events:none;position:absolute;z-index:2;inset:35%;background-color:#000;opacity:.3;border-radius:100%}.square .hl-legal-squares.hl-capture{background-color:transparent!important;border:5px solid #000;z-index:2;border-radius:100%;pointer-events:none;inset:10%;opacity:.3!important}.square.hl-hov-square{border:3px solid #fff}.square.hl-hov-square>.hl-legal-squares{background-color:var(--color-blue);opacity:1}.square .hl-previous-move{position:absolute;inset:0;background-color:var(--color-yellow);opacity:.5;z-index:0}.promotion-container{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;z-index:1000}.promotion-container>.promotion-content{background-color:rgba(255,255,255,.95);padding:.3rem;border-radius:.3rem;box-shadow:var(--shadow-md)}.promotion-content>.promotion-square{display:inline-block;margin:.3rem;cursor:pointer}.checkmate,.eval.horizontal{display:flex;position:absolute}.promotion-content>.promotion-square:hover{background-color:rgba(0,0,0,.1)}.promotion-square>img{user-select:none;pointer-events:none;touch-action:none}.checkmate-container{position:absolute;inset:0;pointer-events:none;user-select:none;z-index:5}.checkmate{top:2%;right:2%;justify-content:center;align-items:center;border-radius:100%;padding:.3rem;font-size:1.135rem;font-weight:700;box-shadow:var(--shadow-md)}.checkmate.white{background-color:#fff;color:#000}.checkmate.black{background-color:#000;color:#fff}.eval{background-color:#ddd;border-radius:.3rem;position:relative}.eval.vertical{width:25px;height:var(--board-size)}.eval.horizontal{height:25px;width:var(--board-size);border-radius:0;top:0;justify-content:end}.eval .bar{background-color:#555;transition:750ms ease-in-out}.eval.vertical .bar{height:50%}.eval.horizontal .bar{width:50%}.eval .num{position:absolute;font-size:.75rem;font-weight:500;color:#fff}.eval.vertical .num{margin:0 auto;text-align:center;left:0;right:0;top:2%}.eval.horizontal .num{right:1.5%}.eval .num.w{color:#000}.eval.vertical .num.w{top:auto;bottom:2%}.eval.horizontal .num.w{left:1.5%;right:auto}.pgn-container{width:inherit}.pgn{display:grid;grid-template-columns:repeat(1,1fr);column-gap:.3rem}.pgn-row{display:flex;align-items:center;padding:0 1.5rem}.pgn-row:nth-child(2n){background-color:rgba(0,0,0,.05)}.pgn-col{flex:1;text-align:center}.pgn button{padding:0 .5rem;border:none;outline:0;background:0 0;cursor:pointer;border-radius:.3rem .3rem 0 0;border-bottom:3px solid transparent}.pgn button.active,.pgn button:hover{border-bottom:3px solid #ccc!important}.pgn button.active{border:1px solid #ccc;font-weight:500;background-color:#fefefe} .actions,.actions .group{display:flex;column-gap:1rem}.actions{justify-content:space-between;align-items:center;width:100vw;padding:0 1rem;user-select:none}.actions .group{align-items:center}@media (min-width:600px){.actions{width:600px}}.actions button{border-radius:.3rem;outline:0;background:0 0;border:none;color:#fff;cursor:pointer;opacity:.3;transition:.3s ease-in-out}.actions button:hover{opacity:1;text-decoration:underline}#thinking,.actions button.glow{color:#87ceeb;opacity:1} </style> </head> <body> <div class="eval horizontal"> <div class="bar"></div> <div class="num"></div> </div> <div id="app"> <main> <div class="fen">FEN</div> <div class="core"> <div class="eval vertical"> <div class="bar"></div> <div class="num"></div> </div> <div class="board"> <div class="square light"> <div class="rank">8</div> <div class="file flip">h</div> <div class="piece rook" data-color="black"> <img src="" alt="r" /> </div> </div> <div class="square dark"> <div class="piece knight" data-color="black"> <img src="" alt="n" /> </div> </div> <div class="square light"> <div class="piece bishop" data-color="black"> <img src="" alt="b" /> </div> </div> <div class="square dark"> <div class="piece queen" data-color="black"> <img src="" alt="q" /> </div> </div> <div class="square light"> <div class="piece king" data-color="black"> <img src="" alt="k" /> </div> </div> <div class="square dark"> <div class="piece bishop" data-color="black"> <img src="" alt="b" /> </div> </div> <div class="square light"> <div class="piece knight" data-color="black"> <img src="" alt="n" /> </div> </div> <div class="square dark"> <div class="piece rook" data-color="black"> <img src="" alt="r" /> </div> </div> <div class="square dark"> <div class="rank">7</div> <div class="piece pawn" data-color="black"> <img src="" alt="p" /> </div> </div> <div class="square light"> <div class="piece pawn" data-color="black"> <img src="" alt="p" /> </div> </div> <div class="square dark"> <div class="piece pawn" data-color="black"> <img src="" alt="p" /> </div> </div> <div class="square light"> <div class="piece pawn" data-color="black"> <img src="" alt="p" /> </div> </div> <div class="square dark"> <div class="piece pawn" data-color="black"> <img src="" alt="p" /> </div> </div> <div class="square light"> <div class="piece pawn" data-color="black"> <img src="" alt="p" /> </div> </div> <div class="square dark"> <div class="piece pawn" data-color="black"> <img src="" alt="p" /> </div> </div> <div class="square light"> <div class="piece pawn" data-color="black"> <img src="" alt="p" /> </div> </div> <div class="square light"> <div class="rank">6</div> </div> <div class="square dark"></div> <div class="square light"></div> <div class="square dark"></div> <div class="square light"></div> <div class="square dark"></div> <div class="square light"></div> <div class="square dark"></div> <div class="square dark"> <div class="rank">5</div> </div> <div class="square light"></div> <div class="square dark"></div> <div class="square light"></div> <div class="square dark"></div> <div class="square light"></div> <div class="square dark"></div> <div class="square light"></div> <div class="square light"> <div class="rank">4</div> </div> <div class="square dark"></div> <div class="square light"></div> <div class="square dark"></div> <div class="square light"></div> <div class="square dark"></div> <div class="square light"></div> <div class="square dark"></div> <div class="square dark"> <div class="rank">3</div> </div> <div class="square light"></div> <div class="square dark"></div> <div class="square light"></div> <div class="square dark"></div> <div class="square light"></div> <div class="square dark"></div> <div class="square light"></div> <div class="square light"> <div class="rank">2</div> <div class="piece pawn" data-color="white"> <img src="" alt="P" /> </div> </div> <div class="square dark"> <div class="piece pawn" data-color="white"> <img src="" alt="P" /> </div> </div> <div class="square light"> <div class="piece pawn" data-color="white"> <img src="" alt="P" /> </div> </div> <div class="square dark"> <div class="piece pawn" data-color="white"> <img src="" alt="P" /> </div> </div> <div class="square light"> <div class="piece pawn" data-color="white"> <img src="" alt="P" /> </div> </div> <div class="square dark"> <div class="piece pawn" data-color="white"> <img src="" alt="P" /> </div> </div> <div class="square light"> <div class="piece pawn" data-color="white"> <img src="" alt="P" /> </div> </div> <div class="square dark"> <div class="piece pawn" data-color="white"> <img src="" alt="P" /> </div> </div> <div class="square dark"> <div class="file">a</div> <div class="rank">1</div> <div class="piece rook" data-color="white"> <img src="" alt="R" /> </div> </div> <div class="square light"> <div class="file">b</div> <div class="piece knight" data-color="white"> <img src="" alt="N" /> </div> </div> <div class="square dark"> <div class="file">c</div> <div class="piece bishop" data-color="white"> <img src="" alt="B" /> </div> </div> <div class="square light"> <div class="file">d</div> <div class="piece queen" data-color="white"> <img src="" alt="Q" /> </div> </div> <div class="square dark"> <div class="file">e</div> <div class="piece king" data-color="white"> <img src="" alt="K" /> </div> </div> <div class="square light"> <div class="file">f</div> <div class="piece bishop" data-color="white"> <img src="" alt="B" /> </div> </div> <div class="square dark"> <div class="file">g</div> <div class="piece knight" data-color="white"> <img src="" alt="N" /> </div> </div> <div class="square light"> <div class="file">h</div> <div class="piece rook" data-color="white"> <img src="" alt="R" /> </div> </div> </div> </div> <div class="actions"> <div class="group"> <button id="btnVsBot">vs Bot</button> <span id="thinking" style="display: none">Thinking...</span> </div> <div class="group"> <button id="btnAutoFlip">Auto</button> <button id="btnFlip">Flip</button> </div> </div> </main> <aside> <div style="padding: 0.3rem"> <button id="btnCopyFenPGN">Copy</button> </div> <div class="pgn-container"> <div class="pgn"> </div> </div> </aside> </div> <script defer> let autoFlip=!1,flip=!1;(()=>{const e=document.querySelector(".board"),t=document.querySelector(".eval.vertical");document.getElementById("btnAutoFlip").addEventListener("click",e=>{(autoFlip=!autoFlip)?e.target.classList.add("glow"):e.target.classList.remove("glow")}),document.getElementById("btnFlip").addEventListener("click",()=>{(flip=!flip)?(e.classList.add("flip"),t.classList.add("flip")):(e.classList.remove("flip"),t.classList.remove("flip"))})})(); const uuid=(t=Math,r=16,n=e=>t.floor(e).toString(r),e=e=>" ".repeat(e).replace(/./g,()=>n(t.random()*r)))=>e(8)+"-"+e(4)+"-"+e(4)+"-"+e(4)+"-"+e(12),fenPieceMapping={k:"king",q:"queen",r:"rook",b:"bishop",n:"knight",p:"pawn"},imgPieceMapping={K:"https://camo.githubusercontent.com/62c11c3baeb64bb613477a801c4b1800ae9635787781a46df0764bedd13316a2/68747470733a2f2f696d616765732e6368657373636f6d66696c65732e636f6d2f63686573732d7468656d65732f7069656365732f6e656f2f3235362f776b2e706e67",Q:"https://camo.githubusercontent.com/5355dc4fabd7332b7c9efbda6181a340b523a5c6af1024b754fa8a6bac1b6adc/68747470733a2f2f696d616765732e6368657373636f6d66696c65732e636f6d2f63686573732d7468656d65732f7069656365732f6e656f2f3235362f77712e706e67",R:"https://camo.githubusercontent.com/7f7d0fa494d14c703ddc252acfeae189d9c2cde7df9b2db633e401f4bcccb454/68747470733a2f2f696d616765732e6368657373636f6d66696c65732e636f6d2f63686573732d7468656d65732f7069656365732f6e656f2f3235362f77722e706e67",B:"https://camo.githubusercontent.com/eb5f49b35878daa563b98e12a5ef8be5aa1a5c3c6f00bb324069236906bfc726/68747470733a2f2f696d616765732e6368657373636f6d66696c65732e636f6d2f63686573732d7468656d65732f7069656365732f6e656f2f3235362f77622e706e67",N:"https://camo.githubusercontent.com/753d80753907c1c87695bc7af443b5497548cf80ca86ca5c1d14ac51a2882632/68747470733a2f2f696d616765732e6368657373636f6d66696c65732e636f6d2f63686573732d7468656d65732f7069656365732f6e656f2f3235362f776e2e706e67",P:"https://camo.githubusercontent.com/85a68d2f5b15f2c0db6b413107551750d94a4e6d169d1b03e124a1cf22c0be6d/68747470733a2f2f696d616765732e6368657373636f6d66696c65732e636f6d2f63686573732d7468656d65732f7069656365732f6e656f2f3235362f77702e706e67",k:"https://camo.githubusercontent.com/048639d5786097a13281555384c109bf7141243637166cea81558e653f85aca7/68747470733a2f2f696d616765732e6368657373636f6d66696c65732e636f6d2f63686573732d7468656d65732f7069656365732f6e656f2f3235362f626b2e706e67",q:"https://camo.githubusercontent.com/b008134eb7a4f81538d1497dee497493ee7a2b36ea3ca66bc5826c2b28e180e0/68747470733a2f2f696d616765732e6368657373636f6d66696c65732e636f6d2f63686573732d7468656d65732f7069656365732f6e656f2f3235362f62712e706e67",r:"https://camo.githubusercontent.com/217225a4110e4452de523b852e8d6453c79f151ffdcf0d9f132fe0a1a04a9f03/68747470733a2f2f696d616765732e6368657373636f6d66696c65732e636f6d2f63686573732d7468656d65732f7069656365732f6e656f2f3235362f62722e706e67",b:"https://camo.githubusercontent.com/14de546dfb3962df816b775ea9f88799183989570515dd102da6d5ea990440c6/68747470733a2f2f696d616765732e6368657373636f6d66696c65732e636f6d2f63686573732d7468656d65732f7069656365732f6e656f2f3235362f62622e706e67",n:"https://camo.githubusercontent.com/f186b4fba73efc8409ad7009a95cddb76de920cc6b23b24b6dc7ec898b4f7fbf/68747470733a2f2f696d616765732e6368657373636f6d66696c65732e636f6d2f63686573732d7468656d65732f7069656365732f6e656f2f3235362f626e2e706e67",p:"https://camo.githubusercontent.com/d692239020765c1c3003d876061b9bd68ac40cb5166f6b21788cf4f87ba9f32a/68747470733a2f2f696d616765732e6368657373636f6d66696c65732e636f6d2f63686573732d7468656d65732f7069656365732f6e656f2f3235362f62702e706e67"};function start(){const a="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1";var e=a.split(" ");const O=e[0];let f=!e[1]||"w"===e[1],w="e1",C="e8",y=[],k=[],s=[],d=null,u=null,q=!0,S=[],L=null,p=[],l="black",h=!1,m=[];const U=["g1","g8","c1","c8"],n="hl-hov-square",_="hl-previous-move",H="hl-legal-squares",F="hl-capture";G(),k=[],S=[],s=[],y=[],d=null,L=null,l="black",p=[],m=[],u=null,q=!0;var Q=document.getElementsByClassName("square"),$=function(e){return e.replace(/\d/g,e=>"1".repeat(+e))}(O).split("/");for(let n=0;n<Q.length;n++){var o=8-Math.floor(n/8),c=String.fromCharCode(97+n%8),i=97-c.charCodeAt(0),g=Q[n];g.id=c+o;let e="",t="",r="";c=$[8-o].charAt(-i);isNaN(+c)?(e=function(e){return e===e.toUpperCase()}(c)?"white":"black",t=fenPieceMapping[c.toLowerCase()],r=uuid(),"king"===t&&("white"===e&&(w=g.id),"black"===e)&&(C=g.id)):(e=null,t=null,r=null),k.push({squareId:g.id,color:e,pieceType:t,pieceId:r}),g.querySelectorAll(".piece").forEach(e=>{e.remove()}),r&&((o=document.createElement("div")).id=r,o.dataset.color=e,o.classList.add("piece"),o.classList.add(t),o.addEventListener("pointerdown",R),(i=document.createElement("img")).src=imgPieceMapping[c],i.alt=c,i.setAttribute("draggable",!1),o.appendChild(i),g.appendChild(o))}var e=Se(),t=(s.push(e),document.querySelector(".fen")),K=(t&&(t.textContent=e),document.getElementsByClassName("square")),t=e=>e.remove();document.querySelectorAll(".file").forEach(t),document.querySelectorAll(".rank").forEach(t);for(let e=0;e<K.length;e++){var r,v,D=String.fromCharCode(97+e%8),j=8-Math.floor(e/8),b=K[e];56<=e&&e<=64&&((r=document.createElement("div")).classList.add("file"),b.prepend(r),r.textContent=D),(e+1)%8==1&&((r=document.createElement("div")).classList.add("rank"),b.prepend(r),r.textContent=j),0<=e&&e<=7&&((v=document.createElement("div")).classList.add("file"),v.classList.add("flip"),b.prepend(v),v.textContent=D),(e+1)%8==0&&((v=document.createElement("div")).classList.add("rank"),v.classList.add("flip"),b.prepend(v),v.textContent=j)}function z(){document.querySelector(".board").removeEventListener("pointerleave",W);var t=document.getElementsByClassName("square");for(let e=0;e<t.length;e++)t[e].removeEventListener("pointermove",V),t[e].removeEventListener("pointerup",Y),t[e].removeEventListener("pointerout",X)}function G(){var t=document.getElementsByClassName("square");for(let e=0;e<t.length;e++){var r=String.fromCharCode(97+e%8),n=8-Math.floor(e/8);t[e].id=r+n}}function E(e,t="#"){var r=B(e).color,n=document.getElementById(e);if(!e)throw new Error("[CHESS_ERROR] Unable to insert checkmate emblem in squareId: "+e);var e=document.createElement("div"),o=document.createElement("div"),a=.45*n.getBoundingClientRect().height;e.classList.add("checkmate-container"),o.textContent=t,o.classList.add("checkmate"),o.classList.add(r),o.style.height=a+"%",o.style.width=a+"%",e.append(o),n.append(e)}function I(e=null){var t=document.getElementById(e);e&&t?(e=t.querySelector(".checkmate-container"))&&e.remove():document.querySelectorAll(".checkmate-container").forEach(e=>{e.remove()})}function V(e){q&&u&&(J(e),e.preventDefault(),(2===(e=e.target).id.length?e:e.parentElement).classList.add(n))}function X(e){q&&(e.preventDefault(),e.target.classList.remove(n))}function Y(e){e.preventDefault(),z();document.querySelectorAll("."+n).forEach(e=>e.classList.remove(n));var t=u;if(t){u.classList.remove("dragging"),u=null;for(var r=document.getElementsByClassName(H);0<r.length;)r[0].remove();t=e.currentTarget.id;Z(d,t)}}function R(t){if(q){var r=t.target,o=(G(),document.querySelector(".board").addEventListener("pointerleave",W),document.getElementsByClassName("square"));for(let e=0;e<o.length;e++)o[e].addEventListener("pointermove",V),o[e].addEventListener("pointerup",Y),o[e].addEventListener("pointerout",X);var a=r.parentElement.id;let{color:n,pieceType:e}=B(d=a);var c=f&&"white"===n,i=!f&&"black"===n;if(c||i){if(r.classList.add("dragging"),document.body.append(r),u=r,J(t),y=Ee(y=[...te(a)],a,n,e),y=[...new Set(y)],"king"===e){c=M(a,n);const l="white"===n?1:8;i=we(n),r=Ce(n);let e=!1,t=!1;i&&(e=M("f"+l,n)),r&&(t=M("d"+l,n)),c&&(i||r)?y=y.filter(e=>!U.includes(e)):(e&&(y=y.filter(e=>e!=="g"+l)),t&&(y=y.filter(e=>e!=="c"+l)))}y.forEach(e=>{var t=B(e).color,e=document.getElementById(e),r=document.createElement("div");r.classList.add(H),e.appendChild(r),t&&t!==n&&r.classList.add(F)})}}}function J(t){if(u){var r=u,n=r.getBoundingClientRect().width;let e=r.getBoundingClientRect().height;n=t.clientX-n/2;e=t.clientY-e/2,("ontouchstart"in window||0<navigator.maxTouchPoints)&&(e-=50),r.style.left=n+"px",r.style.top=e+"px"}}function W(e){z(),document.getElementById(d).append(u),u.classList.remove("dragging"),u=null,document.querySelectorAll("."+H).forEach(e=>e.remove()),document.querySelectorAll("."+n).forEach(e=>e.classList.remove(n))}function Z(n,a,o=!1){let c=null;o&&3===a.length&&(c=a.slice(2,3),a=a.slice(0,2));var i=a,l=document.getElementById(i),{pieceId:d,pieceType:f,color:s}=B(n),u=B(i).color,p=document.getElementById(d),a=(o&&y.push(a),n===i),h=!y.includes(i);if(a||h)document.getElementById(n).appendChild(p),y=[];else{let e=void 0;if("king"===f){if(M(i,s))return;if(U.includes(i)&&!N(s)){{a=s;var h=i;a="white"===a?1:8;let e=null,t=null;h==="g"+a&&(e="h"+a,t="f"+a);h==="c"+a&&(e="a"+a,t="d"+a);h=B(e).pieceId,a=document.getElementById(h),h=document.getElementById(t);h.append(a),ee(k,e,t)}e=!0}"white"===s?w=i:C=i}let t=!1;if(u){if(u===s)return;h=l.querySelector(".piece");h.removeEventListener("pointerdown",R),l.removeChild(h),t=!0}if(L===i){a=s;if(L){a="white"===a?-1:1,a=+L[1]+a,a=B(""+L[0]+a);let e=document.getElementById(a.squareId).querySelector(".piece");e&&(e.remove(),e.removeEventListener("pointerdown",R)),(e=document.getElementById(a.pieceId))&&(e.remove(),e.removeEventListener("pointerdown",R)),a.color=null,a.pieceId=null,a.pieceType=null}t=!0}if(!p)throw new Error(`[CHESS_ERROR] Unable to move piece with id (${d}) positioned at squareId: `+n);l.appendChild(p),ee(k,n,i),y=[],L=null,"pawn"===f&&(u="white"===s?3:6,+n[1]==(h="white"===s?2:7))&&+i[1]==h+("white"===s?2:-2)&&(L=""+i[0]+u);let r=void 0;"pawn"===f&&(a="white"===s&&8==+i[1],d="black"===s&&1==+i[1],a||d)&&(r="pending"),S.push({from:n,to:i,color:s,pieceType:f,hasCapture:t,castle:e,promotion:r});document.querySelectorAll("."+_).forEach(e=>{e.remove()});p=document.getElementById(n),h=document.createElement("div"),u=document.createElement("div");if(h.classList.add(_),u.classList.add(_),p.appendChild(h),l.appendChild(u),r){if(!o){q=!1;{var m=i;if(2<m.length)throw new Error("[CHESS_ERROR] Invalid square id. Unable to promote.");let o=B(m).color,e="white"===o?8:1;if(8!=e&&1!=e)return;if("white"===o&&+m[1]!=e)throw new Error("[CHESS_ERROR] Unable to promote white with squareId: "+m);if("black"===o&&+m[1]!=e)throw new Error("[CHESS_ERROR] Unable to promote black with squareId: "+m);const g=document.createElement("div"),v=document.createElement("div");g.classList.add("promotion-container"),v.classList.add("promotion-content"),g.append(v);let t=["Q","R","B","N"];"black"===o&&(t=t.map(e=>e.toLowerCase()));a=document.getElementById(m);if(!a)throw new Error("[CHESS_ERROR] Board square was not found");const b=.95*a.getBoundingClientRect().height,E=(t.forEach((e,t)=>{var r=document.createElement("div"),n=document.createElement("img");n.src=imgPieceMapping[e],n.alt=e,n.height=b,n.width=b,r.addEventListener("click",()=>{ke(o,fenPieceMapping[e.toLowerCase()],m),g.remove(),ye(e),q=!0,qe()}),r.classList.add("promotion-square"),r.append(n),v.append(r),1===t&&v.append(document.createElement("br"))}),document.querySelector(".board"));if(E)return void E.append(g);throw new Error("[CHESS_ERROR] Board was not found");return}}ye(c),ke(s,fenPieceMapping[c],i)}qe()}}function B(t,e=k){e=e.find(e=>e.squareId===t);if(e)return e;throw new Error(`[CHESS_ERROR] Square with squareId "${t}" was not found`)}function ee(e,t,r){var n=e.findIndex(e=>e.squareId===t),o=e.findIndex(e=>e.squareId===r),n=e[n];e[o]={...n,squareId:r},n.color=null,n.pieceId=null,n.pieceType=null}function A(e){return[e.charAt(0),+e.charAt(1)]}function te(e,t=k){var r,n,o,{pieceId:a,color:c,pieceType:i}=B(e);if(!a)throw new Error("[CHESS_ERROR] No piece identified at squareId: "+e);switch(i){case"pawn":return[r,n,o=k]=[e,c,t],[...ne(r,n,o),...function(e,t,r=k){let[n,o]=A(e),a=[],c=n,i=o;e="white"===t?1:-1;i+=e;var e=""+c+i,l=B(e,r);return l.pieceId||(a.push(e),"white"===t&&2===o&&i++,"black"===t&&7===o&&i--,e=""+c+i,B(e,r).pieceId)||a.push(e),a}(r,n,o)];case"knight":return oe(e,c,t);case"rook":return ae(e,c,t);case"bishop":return ce(e,c,t);case"queen":return ie(e,c,t);case"king":return le(e,c,t);default:throw new Error("[CHESS_ERROR] Unknown piece type")}}function re(n,t){return n.filter(e=>e.color===t).flatMap(({squareId:e,color:t,pieceType:r})=>{return Ee(te(e,x(n)),e,t,r)})}function ne(e,t,r=k){var[n,e]=A(e),o=[],a=e,e="white"===t?1:-1;if(!(8<(a+=e)||a<1)){var c,i;for(const l of[-1,1])"a"<=(i=String.fromCharCode(n.toLowerCase().charCodeAt(0)+l))&&i<="h"&&(c=B(i=""+i+a,r).color,c&&c!==t&&o.push(i),c||i!==L||o.push(i))}return o}function oe(e,t,r=k){return[...ve(e,t,[[-1,2],[1,2],[-2,1],[2,1],[-2,-1],[2,-1],[-1,-2],[1,-2]],r)]}function ae(e,t,r=k){e=A(e);return[...de(e,t,r),...fe(e,t,r),...se(e,t,r),...ue(e,t,r)]}function ce(e,t,r=k){e=A(e);return[...pe(e,t,r),...he(e,t,r),...me(e,t,r),...ge(e,t,r)]}function ie(e,t,r=k){e=A(e);return[...de(e,t,r),...fe(e,t,r),...se(e,t,r),...ue(e,t,r),...pe(e,t,r),...he(e,t,r),...me(e,t,r),...ge(e,t,r)]}function le(e,t,r=k){var n="white"===t?1:8,o=[];return we(t,r)&&o.push("g"+n),Ce(t,r)&&o.push("c"+n),[...ve(e,t,[[-1,1],[0,1],[1,1],[-1,-1],[0,-1],[1,-1],[-1,0],[1,0]],r),...o]}function T({file:e,rank:t,color:r,legalSquares:n},o=k){e+=t,t=B(e,o).color;return!(t&&t===r||(n.push(e),t&&t!==r))}function de(e,t,r=k){var n=e[0];let o=e[1];for(var a=[];o<8&&T({file:n,rank:++o,color:t,legalSquares:a},r););return a}function fe(e,t,r=k){var n=e[0];let o=e[1];for(var a=[];1<o&&T({file:n,rank:--o,color:t,legalSquares:a},r););return a}function se(e,t,r=k){let n=e[0];for(var o=e[1],a=[];n<"h";){var c=n.charCodeAt(0)+1;if(!T({file:n=String.fromCharCode(c),rank:o,color:t,legalSquares:a},r))break}return a}function ue(e,t,r=k){let n=e[0];for(var o=e[1],a=[];"a"<n;){var c=n.charCodeAt(0)-1;if(!T({file:n=String.fromCharCode(c),rank:o,color:t,legalSquares:a},r))break}return a}function pe(e,t,r=k){let[n,o]=e;for(var a=[];n<"h"&&o<8;){var c=n.charCodeAt(0)+1,c=(n=String.fromCharCode(c),o++,T({file:n,rank:o,color:t,legalSquares:a},r));if(!c)break}return a}function he(e,t,r=k){let[n,o]=e;for(var a=[];"a"<n&&1<o;){var c=n.charCodeAt(0)-1,c=(n=String.fromCharCode(c),o--,T({file:n,rank:o,color:t,legalSquares:a},r));if(!c)break}return a}function me(e,t,r=k){let[n,o]=e;for(var a=[];"a"<n&&o<8;){var c=n.charCodeAt(0)-1,c=(n=String.fromCharCode(c),o++,T({file:n,rank:o,color:t,legalSquares:a},r));if(!c)break}return a}function ge(e,t,r=k){let[n,o]=e;for(var a=[];n<"h"&&1<o;){var c=n.charCodeAt(0)+1,c=(n=String.fromCharCode(c),o--,T({file:n,rank:o,color:t,legalSquares:a},r));if(!c)break}return a}function ve(e,o,t,a=k){let[c,i]=A(e);const l=[];c;let d,f=void i;return t.forEach(([e,t])=>{d=String.fromCharCode(c.charCodeAt(0)+e),f=i+t;var e=d<"a",t="h"<d,r=8<f,n=f<1;e||t||r||n||(t=B(e=d+f,a).color,o!==t&&l.push(e))}),l}function M(e,t,r=k){for(const p of ae(e,t,r)){var{pieceType:n,color:o}=B(p,r);switch(n){case"rook":case"queen":if(t!==o)return!0}}for(const h of ce(e,t,r)){var{pieceType:a,color:c}=B(h,r);switch(a){case"bishop":case"queen":if(t!==c)return!0}}for(const m of oe(e,t,r)){var{pieceType:i,color:l}=B(m,r);if("knight"===i)if(t!==l)return!0}for(const g of le(e,t,r)){var{pieceType:d,color:f}=B(g,r);if("king"===d)if(t!==f)return!0}for(const v of ne(e,t,r)){var{pieceType:s,color:u}=B(v,r);if("pawn"===s)if(t!==u)return!0}return!1}function be(){var e=f?w:C,t=f?C:w,r=f?"white":"black",n=x(k);return M(e,r,n)&&!(0<re(n,r).length)&&(I(),E(e),E(t,"💎"),q=!1,confettis(),1)}function x(e){return e.map(e=>({...e}))}function Ee(r,n,o,a){const c=f?w:C,i=x(k);return[...r].forEach(t=>{var e=x(i);ee(e,n,t),"king"!==a&&M(c,o,e)&&(r=r.filter(e=>e!==t)),"king"===a&&M(t,o,e)&&(r=r.filter(e=>e!==t))}),r}function we(e,t=k){const r="white"===e?1:8;var n=t.find(e=>e.squareId==="f"+r&&e.pieceId),o=t.find(e=>e.squareId==="g"+r&&e.pieceId);return!(n||o||N(e)||P(e,"h"+r,t))}function Ce(e,t=k){const r="white"===e?1:8;var n=t.find(e=>e.squareId==="b"+r&&e.pieceId),o=t.find(e=>e.squareId==="c"+r&&e.pieceId),a=t.find(e=>e.squareId==="d"+r&&e.pieceId);return!(n||o||a||N(e)||P(e,"a"+r,t))}function N(t){return S.find(e=>e.color===t&&"king"===e.pieceType)}function P(t,r,e=k){var e=e.find(e=>e.squareId===r&&e.color===t&&"rook"===e.pieceType),n=S.find(e=>e.color===t&&e.from===r&&"rook"===e.pieceType);return!e||n}function ye(e){var t=S.find(e=>"pending"===e.promotion);if(!t)throw new Error("[CHESS_ERROR] Unable to find promotion move state");t.promotion=e.toUpperCase()}function ke(e,t,r){var n=document.getElementById(r);if(!n)throw new Error("[CHESS_ERROR] Unable to create piece at "+r);var o=n.querySelector(".piece"),o=(o&&(o.removeEventListener("pointerdown",R),o.remove()),uuid()),a=document.createElement("div");a.classList.add("piece"),a.classList.add(t.toLowerCase()),a.dataset.color=e,a.id=o,a.addEventListener("pointerdown",R);let c=t[0].toLowerCase();"knight"===t&&(c="n");var i=document.createElement("img"),i=(i.alt=c,c="white"===e?c.toUpperCase():c.toLowerCase(),i.src=imgPieceMapping[c],a.append(i),n.append(a),B(r));i.pieceId=o,i.pieceType=t,i.color=e}function qe(){setTimeout(()=>{var e;autoFlip&&(e=document.querySelector(".board"),(flip=!flip)?e?.classList.add("flip"):e?.classList.remove("flip"))},500),I(),f=!f,m.push(function({color:a,castle:n,from:c,to:i,pieceType:l,hasCapture:o,promotion:d}){var f=i[0];let s="";n&&("g"===f&&(s="O-O"),"c"===f)&&(s="O-O-O");if("pawn"===l)s+="";else{let e=l.charAt(0).toUpperCase();"knight"===l&&(e="N"),n||(s+=e),(()=>{if("king"!==l){var r=k.filter(e=>e.color===a&&e.pieceType===l&&e.squareId!==c);for(let t=0;t<r.length;t++){var n=r[t].squareId;let e=[];var o="white"===a?"black":"white";if("knight"===l?e=oe(n,o):"bishop"===l?e=ce(n,o):"rook"===l?e=ae(n,o):"queen"===l&&(e=ie(n,o)),e.includes(i)){o=c.charAt(0)===n.charAt(0);s+=o?c.charAt(1):c.charAt(0);break}}}})()}o&&("pawn"===l&&(s+=c.charAt(0)),s+="x");n||(s+=i);d&&(s+="="+d);f="white"===a?"black":"white";o="white"==f?w:C;be()?s+="#":M(o,f)&&(s+="+");n=document.querySelector(".pgn");if(n){let e=Math.floor(S.length/2)+1,t=("black"===a&&e--,null),r=null;d=null,o=document.createElement("button");document.querySelectorAll(".pgn-col button.active").forEach(e=>{e.classList.remove("active")}),"white"===a?(t=document.createElement("div"),r=document.createElement("div"),(d=document.createElement("span")).textContent=e+".",t.append(d),t.append(r),(f=document.createElement("div")).classList.add("pgn-col"),t.append(f)):r=document.querySelector(`.pgn-row:nth-child(${e}) .pgn-col:last-child`),o.textContent=s,t&&(t.classList.add("pgn-row"),n.append(t)),r.classList.add("pgn-col"),o.classList.add("active"),r.append(o)}return s}(S[S.length-1]));var e,t,r="white"===l&&f,n="black"===l&&!f,o=Se(),a=(s.push(o),document.querySelector(".fen"));a&&(a.textContent=o);let c=!1,i=!1;!function(){const r=e=>e.split(" ").slice(0,4).join(" ");return s.some(e=>{const t=r(e);return 3<=s.filter(e=>r(e)===t).length})}()||(E(w,"½"),E(C,"½")),function(e=s[s.length-1]){var e=e.split(" ")[0],t=e.split("").filter(e=>"B"===e).length,r=e.split("").filter(e=>"b"===e).length,n=e.split("").filter(e=>"N"===e).length,o=e.split("").filter(e=>"n"===e).length,a=e.split("").filter(e=>"Q"===e).length,c=e.split("").filter(e=>"q"===e).length,i=e.split("").filter(e=>"R"===e).length,l=e.split("").filter(e=>"r"===e).length,d=e.split("").filter(e=>"P"===e).length,e=e.split("").filter(e=>"p"===e).length;if(0<a+c+i+l+d+e)return;if(1<n+o)return;if(1<t+r)return;if((0<t||0<r)&&0<n+o)return;return 1}()&&(I(),E(w,"🤝"),E(C,"🤝"),q=!1,c=!0),!(i=c||!be()&&(a=f?w:C,o=f?C:w,e=f?"white":"black",t=x(k),M(a,e,t)||0<re(t,e).length||(I(),E(a,"❓"),E(o,"😨"),q=!1))?i:!0)&&100<=Le()&&(E(w,"🥵"),E(C,"🥵")),Ie(h&&(r||n))}function Se(t=k){let r="",n=8,o=0;for(var a=()=>{r=r.replace(/\*+/g,o),o=0};1<=n;){for(let e="a";e<="h";e=(c=e,String.fromCharCode(c.charCodeAt(0)+1))){const d=e+n;var c=t.find(e=>e.squareId===d);if(!c)throw new Error("[CHESS_ERROR] Unable to generate FEN due to missing squareId: "+d);var{color:c,pieceType:i}=c;i?(i="knight"===i?"n":i.charAt(0).toLowerCase(),a(),r+="white"===c?i.toUpperCase():i):(r+="*",o++)}a(),1<n&&(r+="/"),n--}r+=f?" w ":" b ";let e="";N("white")||P("white","h1")||(e+="K"),N("white")||P("white","a1")||(e+="Q"),N("black")||P("black","h8")||(e+="k"),N("black")||P("black","a8")||(e+="q"),e=e||"-",r=(r+=e+" ")+(L||"-")+" ";var l=Le(),l=(r+=l+" ",Math.floor(S.length/2)+1);return r+=l}function Le(){let t=0;for(let e=0;e<S.length;e++)t++,(S[e].hasCapture||"pawn"===S[e].pieceType||S[e].promotion)&&(t=0);return t}function Ie(l,e=s[s.length-1]){l&&(q=!1);var{from:t,to:r}=e=e||a,e=`https://stockfish.online/api/s/v2.php?fen=${encodeURI(e)}&depth=15`;if(l&&p.length){var{from:n,to:o}=p.splice(0,1)[0];if(n===t&&o===r)return q=!0,void Z((n=p[0]).from,n.to,!0)}const d=document.getElementById("thinking");l&&d&&(d.style.display="inline-block"),fetch(e).then(e=>e.json()).then(e=>{if(!e.success)throw new Error("SF failed");var t=e.evaluation,r=e.mate,n=50-(t=null===t&&null!==r?0<r?15:-15:t)/15*100,o=(n=Math.min(n,98),n=Math.max(n,2),document.querySelector(".eval.vertical .bar")),a=document.querySelector(".eval.vertical .num"),c=document.querySelector(".eval.horizontal .bar"),i=document.querySelector(".eval.horizontal .num");if(o&&(o.style.height=n+"%"),c&&(c.style.width=n+"%"),a){let e=Math.abs(t).toFixed(1);null!==r&&(e="M"+Math.abs(r)),a.textContent=e,0<t?a.classList.add("w"):a.classList.remove("w")}if(i){let e=Math.abs(t).toFixed(1);null!==r&&(e="M"+Math.abs(r)),i.textContent=e,0<t?i.classList.add("w"):i.classList.remove("w")}if(l){q=!0,d&&(d.style.display="none");o=(p=function(e){e=e.split(" ");return e.map(e=>({from:e.slice(0,2),to:e.slice(2,5)}))}(e.continuation)).splice(0,1);if(!o.length)throw new Error("[SF_ERROR] No more moves found");var{from:c,to:n}=o[0];Z(c,n,!0)}}).catch(e=>console.error(e))}document.getElementById("btnVsBot").addEventListener("click",e=>{h=!h,q&&(h?(e.target.classList.add("glow"),l=f?"white":"black",Ie(!(q=!1))):e.target.classList.remove("glow"))}),document.getElementById("btnCopyFenPGN").addEventListener("click",()=>{let t=`[FEN "${a}"]`;m.length&&(t+="\n\n");for(let e=0;e<m.length;e++){var r=Math.floor(e/2)+1;e%2==0&&(t+=r+". "),t+=m[e]+" "}navigator.clipboard.writeText(t),alert("FEN/PGN copied to clipboard")})}start(); !function(t,e){!function e(z,a,c,d){var n=!!(z.Worker&&z.Blob&&z.Promise&&z.OffscreenCanvas&&z.OffscreenCanvasRenderingContext2D&&z.HTMLCanvasElement&&z.HTMLCanvasElement.prototype.transferControlToOffscreen&&z.URL&&z.URL.createObjectURL);function i(){}function O(t){var e=a.exports.Promise,e=void 0!==e?e:z.Promise;return"function"==typeof e?new e(t):(t(i,i),null)}r=Math.floor(1e3/60),l={},s=0,o="function"==typeof requestAnimationFrame&&"function"==typeof cancelAnimationFrame?(t=function(a){var n=Math.random();return l[n]=requestAnimationFrame(function t(e){s===e||s+r-1<e?(s=e,delete l[n],a()):l[n]=requestAnimationFrame(t)}),n},function(t){l[t]&&cancelAnimationFrame(l[t])}):(t=function(t){return setTimeout(t,r)},function(t){return clearTimeout(t)});var t,o,r,l,s,f,h,u,g,m={frame:t,cancel:o},b=function(){var o;if(!f&&(!c&&n)){var t=["var CONFETTI, SIZE = {}, module = {};","("+e.toString()+")(this, module, true, SIZE);","onmessage = function(msg) {"," if (msg.data.options) {"," CONFETTI(msg.data.options).then(function () {"," if (msg.data.callback) {"," postMessage({ callback: msg.data.callback });"," }"," });"," } else if (msg.data.reset) {"," CONFETTI && CONFETTI.reset();"," } else if (msg.data.resize) {"," SIZE.width = msg.data.resize.width;"," SIZE.height = msg.data.resize.height;"," } else if (msg.data.canvas) {"," SIZE.width = msg.data.canvas.width;"," SIZE.height = msg.data.canvas.height;"," CONFETTI = module.exports.create(msg.data.canvas);"," }","}"].join("\n");try{f=new Worker(URL.createObjectURL(new Blob([t])))}catch(t){return"function"==typeof console.warn&&console.warn("🎊 Could not load worker",t),null}(o=f).init=function(t){t=t.transferControlToOffscreen();o.postMessage({canvas:t},[t])},o.fire=function(t,e,n){var i;return h?(r(t,null),h):(i=Math.random().toString(36).slice(2),h=O(function(e){function a(t){t.data.callback===i&&(delete u[i],o.removeEventListener("message",a),h=null,n(),e())}o.addEventListener("message",a),r(t,i),u[i]=a.bind(null,{data:{callback:i}})}))},o.reset=function(){for(var t in o.postMessage({reset:!0}),u)u[t](),delete u[t]}}return f;function r(t,e){o.postMessage({options:t||{},callback:e})}},p={particleCount:50,angle:90,spread:45,startVelocity:45,decay:.9,gravity:1,drift:0,ticks:200,x:.5,y:.5,shapes:["square","circle"],zIndex:100,colors:["#26ccff","#a25afd","#ff5e7e","#88ff5a","#fcff42","#ffa62d","#ff36ff"],disableForReducedMotion:!(u={}),scalar:1};function L(t,e,a){return t=(t&&null!=t[e]?t:p)[e],a?a(t):t}function A(t){return t<0?0:Math.floor(t)}function v(t){return parseInt(t,16)}function V(t){return t.map(y)}function y(t){t=String(t).replace(/[^0-9a-f]/gi,"");return{r:v((t=t.length<6?t[0]+t[0]+t[1]+t[1]+t[2]+t[2]:t).substring(0,2)),g:v(t.substring(2,4)),b:v(t.substring(4,6))}}function M(t){t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight}function w(t){var e=t.getBoundingClientRect();t.width=e.width,t.height=e.height}function B(a,t,n,i,o){var r,l,s=t.slice(),M=a.getContext("2d"),e=O(function(t){function e(){r=l=null,M.clearRect(0,0,i.width,i.height),o(),t()}r=m.frame(function t(){!c||i.width===d.width&&i.height===d.height||(i.width=a.width=d.width,i.height=a.height=d.height),i.width||i.height||(n(a),i.width=a.width,i.height=a.height),M.clearRect(0,0,i.width,i.height),(s=s.filter(function(t){var e=M,a=t;a.x+=Math.cos(a.angle2D)*a.velocity+a.drift,a.y+=Math.sin(a.angle2D)*a.velocity+a.gravity,a.wobble+=a.wobbleSpeed,a.velocity*=a.decay,a.tiltAngle+=.1,a.tiltSin=Math.sin(a.tiltAngle),a.tiltCos=Math.cos(a.tiltAngle),a.random=Math.random()+2,a.wobbleX=a.x+10*a.scalar*Math.cos(a.wobble),a.wobbleY=a.y+10*a.scalar*Math.sin(a.wobble);var n,i,o,r,l,s,t=a.tick++/a.totalTicks,c=a.x+a.random*a.tiltCos,d=a.y+a.random*a.tiltSin,f=a.wobbleX+a.random*a.tiltCos,h=a.wobbleY+a.random*a.tiltSin;if(e.fillStyle="rgba("+a.color.r+", "+a.color.g+", "+a.color.b+", "+(1-t)+")",e.beginPath(),"circle"===a.shape)e.ellipse?e.ellipse(a.x,a.y,Math.abs(f-c)*a.ovalScalar,Math.abs(h-d)*a.ovalScalar,Math.PI/10*a.wobble,0,2*Math.PI):(t=e,n=a.x,i=a.y,o=Math.abs(f-c)*a.ovalScalar,r=Math.abs(h-d)*a.ovalScalar,l=Math.PI/10*a.wobble,s=2*Math.PI,t.save(),t.translate(n,i),t.rotate(l),t.scale(o,r),t.arc(0,0,1,0,s,void 0),t.restore());else if("star"===a.shape)for(var u,g,m=Math.PI/2*3,b=4*a.scalar,p=8*a.scalar,v=5,y=Math.PI/v;v--;)u=a.x+Math.cos(m)*p,g=a.y+Math.sin(m)*p,e.lineTo(u,g),m+=y,u=a.x+Math.cos(m)*b,g=a.y+Math.sin(m)*b,e.lineTo(u,g),m+=y;else e.moveTo(Math.floor(a.x),Math.floor(a.y)),e.lineTo(Math.floor(a.wobbleX),Math.floor(d)),e.lineTo(Math.floor(f),Math.floor(h)),e.lineTo(Math.floor(c),Math.floor(a.wobbleY));return e.closePath(),e.fill(),a.tick<a.totalTicks})).length?r=m.frame(t):e()}),l=e});return{addFettis:function(t){return s=s.concat(t),e},canvas:a,promise:e,reset:function(){r&&m.cancel(r),l&&l()}}}function x(T,t){var I,k=!T,E=!!L(t||{},"resize"),S=L(t,"disableForReducedMotion",Boolean),F=n&&L(t||{},"useWorker")?b():null,N=k?M:w,P=!(!T||!F||!T.__confetti_initialized),R="function"==typeof matchMedia&&matchMedia("(prefers-reduced-motion)").matches;function e(t){var e=S||L(t,"disableForReducedMotion",Boolean),a=L(t,"zIndex",Number);if(e&&R)return O(function(t){t()});k&&I?T=I.canvas:k&&!T&&(e=a,(a=document.createElement("canvas")).style.position="fixed",a.style.top="0px",a.style.left="0px",a.style.pointerEvents="none",a.style.zIndex=e,T=a,document.body.appendChild(T)),E&&!P&&N(T);var n={width:T.width,height:T.height};function i(){var t;F?(N(t={getBoundingClientRect:function(){if(!k)return T.getBoundingClientRect()}}),F.postMessage({resize:{width:t.width,height:t.height}})):n.width=n.height=null}function o(){I=null,E&&z.removeEventListener("resize",i),k&&T&&(document.body.removeChild(T),T=null,P=!1)}if(F&&!P&&F.init(T),P=!0,F&&(T.__confetti_initialized=!0),E&&z.addEventListener("resize",i,!1),F)return F.fire(t,n,o);for(var r,l,s,e=t,a=n,t=o,c=L(e,"particleCount",A),d=L(e,"angle",Number),f=L(e,"spread",Number),h=L(e,"startVelocity",Number),u=L(e,"decay",Number),g=L(e,"gravity",Number),m=L(e,"drift",Number),b=L(e,"colors",V),p=L(e,"ticks",Number),v=L(e,"shapes"),y=L(e,"scalar"),M=((e=L(e,"origin",Object)).x=L(e,"x",Number),e.y=L(e,"y",Number),c),w=[],x=T.width*e.x,C=T.height*e.y;M--;)w.push((0,r=(s={x:x,y:C,angle:d,spread:f,startVelocity:h,color:b[M%b.length],shape:v[s=v.length,Math.floor(Math.random()*+s)+0],ticks:p,decay:u,gravity:g,drift:m,scalar:y}).angle*(Math.PI/180),l=s.spread*(Math.PI/180),{x:s.x,y:s.y,wobble:10*Math.random(),wobbleSpeed:Math.min(.11,.1*Math.random()+.05),velocity:.5*s.startVelocity+Math.random()*s.startVelocity,angle2D:-r+(.5*l-Math.random()*l),tiltAngle:(.5*Math.random()+.25)*Math.PI,color:s.color,shape:s.shape,tick:0,totalTicks:s.ticks,decay:s.decay,drift:s.drift,random:Math.random()+2,tiltSin:0,tiltCos:0,wobbleX:0,wobbleY:0,gravity:3*s.gravity,ovalScalar:.6,scalar:s.scalar}));return I?I.addFettis(w):(I=B(T,w,N,a,t)).promise}return e.reset=function(){F&&F.reset(),I&&I.reset()},e}function C(){return g=g||x(null,{useWorker:!0,resize:!0})}a.exports=function(){return C().apply(this,arguments)},a.exports.reset=function(){C().reset()},a.exports.create=x}(function(){return void 0!==t?t:"undefined"!=typeof self?self:this||{}}(),e,!1),t.confetti=e.exports}(window,{});const count=200,defaults={origin:{y:.7}};function fire(t,e){confetti(Object.assign({},defaults,e,{particleCount:Math.floor(count*t)}))}function confettis(){fire(.25,{spread:26,startVelocity:55}),fire(.2,{spread:60}),fire(.35,{spread:100,decay:.91,scalar:.8}),fire(.1,{spread:120,startVelocity:25,decay:.92,scalar:1.2}),fire(.1,{spread:120,startVelocity:45})} </script> </body> </html>